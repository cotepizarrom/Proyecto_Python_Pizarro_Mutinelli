{% extends "base.html" %}

{% block title %}Páginas — SUR Consulting{% endblock %}

{% block content %}
  <h1>Páginas</h1>

  <!-- Búsqueda -->
  <form method="get" style="margin: 10px 0 18px; display:flex; gap:8px;">
    <input
      type="text"
      name="q"
      value="{{ q }}"
      placeholder="Buscar por título o subtítulo…"
      style="flex:1; padding:10px; border:1px solid #e6f3f3; border-radius:10px;"
    />
    <button class="btn" type="submit">Buscar</button>
    {% if q %}
      <a class="btn" href="{% url 'page_list' %}">Limpiar</a>
    {% endif %}
  </form>

  <!-- Botón crear (solo logueada) -->
  {% if request.user.is_authenticated %}
    <p><a class="btn btn-primary" href="{% url 'page_create' %}">+ Crear Página</a></p>
  {% endif %}

  {% if pages %}
    {% if q %}
      <p><small>Resultados para “{{ q }}” ({{ page_obj.paginator.count }})</small></p>
    {% endif %}

    <ul>
      {% for p in pages %}
        <li style="margin-bottom:10px;">
          <strong>{{ p.titulo }}</strong>
          {% if p.subtitulo %}<br><em>{{ p.subtitulo }}</em>{% endif %}<br>
          <small>{{ p.fecha_publicacion }}</small><br>
          <a href="{% url 'page_detail' p.pk %}">Leer más</a>
        </li>
      {% endfor %}
    </ul>

    {% if is_paginated %}
      <div>
        {% if page_obj.has_previous %}
          <a href="?q={{ q }}&page={{ page_obj.previous_page_number }}">Anterior</a>
        {% endif %}
        <span>Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}</span>
        {% if page_obj.has_next %}
          <a href="?q={{ q }}&page={{ page_obj.next_page_number }}">Siguiente</a>
        {% endif %}
      </div>
    {% endif %}
  {% else %}
    {% if q %}
      <p><em>No se encontraron páginas para “{{ q }}”.</em></p>
    {% else %}
      <p><em>No hay páginas aún.</em></p>
    {% endif %}
  {% endif %}
{% endblock %}
